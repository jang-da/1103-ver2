<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카제로스 레이드</title>
    <!-- Google Fonts: Noto Serif KR 추가 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- GNB (상단 네비게이션 바) -->
    <header class="gnb">
        <div class="gnb-content">
            <a href="#" class="gnb-logo">
                <img src="images/Lost_Ark_logo.png" alt="로스트아크 로고">
            </a>
            <div class="gnb-right">
                <nav class="gnb-menu">
                    <a href="#section-event1">스토리</a>
                    <a href="#section-entry">입장 조건</a>
                </nav>
                <a href="#" class="gnb-gamestart"><img src="images/gamestart.webp" alt="게임 시작"></a>
            </div>
        </div>
    </header>

    <!-- 배경 동영상 컨테이너 -->
    <div class="video-background">
        <video autoplay muted loop id="bg-video">
            <!-- 여기에 사용할 동영상 파일 경로를 넣어주세요 -->
            <source src="images/mp4.mp4" type="video/mp4">
            이 브라우저는 비디오 태그를 지원하지 않습니다.
        </video>
    </div>

    <!-- 동영상 위에 올라갈 콘텐츠 -->
    <div class="content-overlay">
        <!-- 왼쪽 콘텐츠 -->
        <div class="left-content">
            <div class="text-background animate-on-scroll">
                <div class="title-container">
                    <img src="images/@index_tit1_1 (1).webp" alt="최" class="title-char">
                    <img src="images/@index_tit1_2.webp" alt="후" class="title-char">
                    <img src="images/@index_tit1_3.webp" alt="의" class="title-char">
                    <img src="images/@index_tit1_4.webp" alt="날" class="title-char">
                </div>
                <img src="images/@index_tit2.webp" alt="종막" class="left-image">
                <img src="images/@index_txt.webp" alt="업데이트" class="update-image">

            </div>
        </div>

        <!-- 아래에 추가될 새로운 콘텐츠 -->
        <div id="section-event1" class="new-content-section animate-on-scroll">
            <div class="slider-container">
                <div class="slides-wrapper">
                    <div class="slide"><img src="images/event1_slide1.webp" alt="이벤트 이미지 1"></div>
                    <div class="slide"><img src="images/event1_slide4.webp" alt="이벤트 이미지 2"></div>
                    <div class="slide"><img src="images/event1_slide2.webp" alt="이벤트 이미지 3"></div>
                </div>
                <button class="prev-btn">‹</button>
                <button class="next-btn">›</button>
            </div>
            <div class="text-box">
                <img src="images/@event1_txt1.webp" alt="이벤트 상세 정보">
                <img src="images/@event1_txt2.webp" alt="이벤트 상세 정보">
                <img src="images/@event1_txt3.webp" alt="이벤트 상세 정보">
            </div>
        </div>

        <!-- 단독으로 배치될 이미지 -->
        <img src="images/@event1_txt4.webp" alt="이벤트 상세 정보" class="standalone-image animate-on-scroll">

        <!-- 새로운 이벤트 섹션 2 -->
        <div id="section-event2" class="event2-section animate-on-scroll">
            <!-- 텍스트 콘텐츠 -->
            <div class="event2-text-container">
                <img src="images/@event2_tit.webp" alt="이벤트 제목" class="event2-title">
                <img src="images/@event2_txt1.webp" alt="이벤트 내용 1" class="event2-text">
                <img src="images/@event2_txt2.webp" alt="이벤트 내용 2" class="event2-text">
            </div>
            <!-- 배경 역할을 하는 캐릭터 이미지 -->
            <img src="images/@event2_obj.webp" alt="이벤트 오브젝트" class="event2-object">
        </div>

        <!-- 입장 조건 섹션 -->
        <div id="section-entry" class="entry-conditions-section animate-on-scroll">
            <img src="images/@event4_tit.webp" alt="입장 조건 제목" class="entry-title-img">
            <img src="images/@event4_txt.webp" alt="입장 조건 내용" class="entry-text-img">
            <div class="entry-objects-container">
                <img src="images/@event4_obj1.webp" alt="보상 1" class="entry-object-img">
                <img src="images/@event4_obj2.webp" alt="보상 2" class="entry-object-img">
                <img src="images/@event4_obj3.webp" alt="보상 3" class="entry-object-img">
            </div>
        </div>
    </div>

    <!-- 페이지 하단 푸터 -->
    <footer>
        <div class="footer-content">
            <img src="images/logo_rpg.png" alt="Smilegate RPG Logo" class="footer-logo">
            <div class="footer-text">
                <p>본 페이지는 상업적 목적이 아닌 개인 포트폴리오용으로 제작되었습니다.</p>
                <p>사용된 모든 리소스의 저작권은 스마일게이트 RPG의 로스트아크에 있습니다. &copy; Smilegate RPG. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- GSAP & ScrollTrigger 라이브러리 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>

    <script>
        const slidesWrapper = document.querySelector('.slides-wrapper');
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.querySelector('.prev-btn');
        const nextBtn = document.querySelector('.next-btn');
        let currentIndex = 0;

        function goToSlide(index) {
            const slideWidth = slides[0].clientWidth; // 슬라이드 너비를 함수 호출 시마다 다시 계산
            slidesWrapper.style.transform = `translateX(-${index * slideWidth}px)`;
            currentIndex = index;
        }

        prevBtn.addEventListener('click', () => {
            const newIndex = (currentIndex - 1 + slides.length) % slides.length;
            goToSlide(newIndex);
        });

        nextBtn.addEventListener('click', () => {
            const newIndex = (currentIndex + 1) % slides.length;
            goToSlide(newIndex);
        });

        // 5초마다 자동으로 다음 슬라이드로 이동
        setInterval(() => {
            const newIndex = (currentIndex + 1) % slides.length;
            goToSlide(newIndex);
        }, 5000);

        // 창 크기가 변경될 때 슬라이드 너비를 다시 계산 (반응형 대응)
        window.addEventListener('resize', () => {
            slidesWrapper.style.transition = 'none'; // 너비 변경 시 애니메이션 비활성화
            goToSlide(currentIndex); // 현재 슬라이드로 즉시 이동하여 위치 재조정
            slidesWrapper.offsetHeight; // 브라우저 리플로우 강제
            slidesWrapper.style.transition = 'transform 0.5s ease-in-out'; // 다시 애니메이션 활성화
        });

        document.addEventListener('DOMContentLoaded', () => {
            // --- GSAP ScrollTrigger 플러그인 등록 ---
            gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

            // --- 마우스 움직임에 따른 패럴랙스 효과 ---
            const leftContent = document.querySelector('.left-content');
            leftContent.addEventListener('mousemove', (e) => {
                const { clientX, clientY } = e;
                const { offsetWidth, offsetHeight } = leftContent;
                
                // 화면 중앙을 기준으로 마우스 위치 계산 (-0.5 ~ 0.5 범위)
                const xPos = (clientX / offsetWidth) - 0.5;
                const yPos = (clientY / offsetHeight) - 0.5;

                // 움직일 대상 요소들
                const titleChars = document.querySelectorAll('.title-char');
                const leftImage = document.querySelector('.left-image');
                const updateImage = document.querySelector('.update-image');

                // GSAP를 사용하여 부드럽게 움직임 적용
                // data-depth 속성으로 움직임의 깊이를 조절
                gsap.to(titleChars, { x: -xPos * 30, y: -yPos * 30, stagger: 0.05, duration: 0.5, ease: 'power2.out' });
                gsap.to(leftImage, { x: xPos * 20, y: yPos * 20, duration: 0.5, ease: 'power2.out' });
                gsap.to(updateImage, { x: xPos * 10, y: yPos * 10, duration: 0.5, ease: 'power2.out' });
            });

            // GNB 메뉴 클릭 시 부드럽게 스크롤
            document.querySelectorAll('.gnb-menu a').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    gsap.to(window, { duration: 1, scrollTo: targetId, ease: "power2.inOut" });
                });
            });


            // --- GSAP를 활용한 스크롤 기반 애니메이션 ---
            // 1. 첫 번째 섹션 (최후의 날)
            gsap.from(".title-char", {
                scrollTrigger: ".left-content",
                opacity: 0,
                y: 50,
                stagger: 0.1,
                duration: 0.8,
                ease: "power3.out"
            });
            gsap.from([".left-image", ".update-image"], {
                scrollTrigger: ".left-content",
                opacity: 0,
                y: 30,
                duration: 1,
                delay: 0.5,
                ease: "power3.out"
            });

            // 2. 일반 섹션 등장 애니메이션
            const sections = document.querySelectorAll('.new-content-section, .standalone-image');
            sections.forEach(section => {
                gsap.from(section, {
                scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        toggleActions: "play none none none",
                    },
                    opacity: 0, y: 50, duration: 1, ease: "power3.out"
                });
            });

            // // 3. '잉크 번짐' 전환 효과 (임시 비활성화)
            // gsap.timeline({
            //     scrollTrigger: {
            //         trigger: ".event2-section", // 이 섹션을 기준으로
            //         start: "top bottom",      // 섹션의 상단이 뷰포트 하단에 닿으면 시작
            //         end: "top top",           // 섹션의 상단이 뷰포트 상단에 닿으면 종료
            //         scrub: 1,                 // 스크롤에 따라 부드럽게 제어
            //     }
            // })
            // .to(".event2-section", { 
            //     clipPath: "inset(0 0% 0 0)", // clip-path를 애니메이션하여 요소를 완전히 보이게 함
            //     ease: "none" 
            // })
            // .from(".event2-text-container", { xPercent: -30, opacity: 0 }, "<") // 텍스트는 왼쪽에서
            // .from(".event2-object", { xPercent: 30, opacity: 0 }, "<");       // 이미지는 오른쪽에서 나타남


            // 4. entry-conditions-section 애니메이션 (순차 등장)
            gsap.from(".entry-conditions-section > img", { // 제목과 텍스트 이미지
                scrollTrigger: {
                    trigger: ".entry-conditions-section",
                    start: "top 70%",
                    toggleActions: "play none none none",
                },
                opacity: 0, y: 50, duration: 1, ease: "power3.out"
            });
            gsap.from(".entry-object-img", { // 보상 아이템 이미지들
                scrollTrigger: {
                    trigger: ".entry-objects-container",
                    start: "top 80%",
                    toggleActions: "play none none none",
                },
                opacity: 0, y: 50, stagger: 0.2, duration: 0.8, ease: "power3.out"
            });
        });
    </script>
</body>
</html>